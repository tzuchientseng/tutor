import{d as F,r as y,i as N,j as R,c as r,a as s,k as p,n as O,l as w,m as U,p as M,o as a,e as D,_ as B,f as V,q as I,t as v,F as b,s as Y,h as x,x as H}from"./index-DOeknWn7.js";import{u as W}from"./authStore-xwKZPLQJ.js";const q={class:"navbar"},J=["aria-expanded"],G={key:0,class:"nav-links"},K=F({__name:"HamburgerButton",setup(h){const l=y(!1),i=y(window.innerWidth>=768),u=()=>{l.value=!l.value},d=()=>{i.value=window.innerWidth>=768};return N(()=>{d(),window.addEventListener("resize",d)}),R(()=>{window.removeEventListener("resize",d)}),(_,c)=>{const g=U("RouterLink");return a(),r("nav",q,[s("button",{class:O(["menu-icon",{active:l.value}]),onClick:u,"aria-label":"ÂàáÊèõÈÅ∏ÂñÆ","aria-expanded":l.value.toString()},c[0]||(c[0]=[s("span",{class:"bar top"},null,-1),s("span",{class:"bar middle"},null,-1),s("span",{class:"bar bottom"},null,-1)]),10,J),l.value||i.value?(a(),r("ul",G,[s("li",null,[w(g,{to:"/"},{default:M(()=>c[1]||(c[1]=[D("È¶ñÈ†Å",-1)])),_:1,__:[1]})]),s("li",null,[w(g,{to:"/login"},{default:M(()=>c[2]||(c[2]=[D("Â∏≥ËôüÁôªÂÖ•",-1)])),_:1,__:[2]})]),s("li",null,[w(g,{to:{name:"StudentProgress"}},{default:M(()=>c[3]||(c[3]=[D("Â≠∏ÁøíÁãÄÊ≥Å",-1)])),_:1,__:[3]})]),s("li",null,[w(g,{to:{name:"CourseIntro"}},{default:M(()=>c[4]||(c[4]=[D("Ë™≤Á®ã‰ªãÁ¥π",-1)])),_:1,__:[4]})])])):p("",!0)])}}}),Q=B(K,[["__scopeId","data-v-33f0fc4d"]]),L="https://home.sunnytseng.com/api/tutor/calendar/",X="https://home.sunnytseng.com/api/tutor/import-workhours/",j=V("calendar",()=>{const h=y([]),l=y(!1),i=W(),u=(e={})=>{const t={...e};return i.token&&(t.Authorization=`Bearer ${i.token}`),t},d=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`,_=e=>h.value.filter(t=>d(new Date(t.datetime))===e),c=async()=>{l.value=!0;try{const e=await fetch(L);if(!e.ok)throw new Error("Failed to load event data");const t=await e.json();h.value=t}catch(e){console.error("An error occurred while loading calendar events:",e)}finally{l.value=!1}};return{events:h,loading:l,getEventByDate:_,loadEvents:c,createEvent:async e=>{try{const t=await fetch(L,{method:"POST",headers:u({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok){const $=await t.text();throw new Error($||"Create failed")}const o=await t.json();return h.value.unshift(o),{success:!0,data:o}}catch(t){return{success:!1,message:(t==null?void 0:t.message)||"Create failed"}}},deleteEvent:async e=>{try{const t=await fetch(`${L}${e}/`,{method:"DELETE",headers:u()});if(!t.ok&&t.status!==204){const o=await t.text();throw new Error(o||"Delete failed")}return h.value=h.value.filter(o=>o.id!==e),{success:!0}}catch(t){return{success:!1,message:(t==null?void 0:t.message)||"Delete failed"}}},importWorkhours:async()=>{try{const e=await fetch(X,{method:"POST",headers:u()}),t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||(t==null?void 0:t.message)||"Import failed");return await c(),{success:!0,message:(t==null?void 0:t.message)||"Imported"}}catch(e){return{success:!1,message:(e==null?void 0:e.message)||"Import failed"}}}}}),Z={class:"calendar-container"},ee={key:0,class:"loading-overlay"},te={key:1},se={class:"calendar-header"},ne={class:"calendar-grid"},ae=["onClick"],oe={key:0},re={key:0},le={key:1},ce=F({__name:"ScheduleCalendar",emits:["select-date"],setup(h,{emit:l}){const i=j(),u=y(!0),d=l;N(async()=>{try{await i.loadEvents()}catch(n){console.error("Failed to load events:",n),alert("Unable to load events, please try again later!")}finally{u.value=!1}});const _=new Date,c=y(new Date),g=I(()=>c.value.getFullYear()),S=I(()=>c.value.getMonth()),C=["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"],e=n=>`${n.getFullYear()}-${(n.getMonth()+1).toString().padStart(2,"0")}-${n.getDate().toString().padStart(2,"0")}`,t=I(()=>{const n=g.value,f=S.value,m=new Date(n,f,1),T=new Date(n,f+1,0),E=[];for(let k=0;k<m.getDay();k++)E.push(null);for(let k=1;k<=T.getDate();k++)E.push(new Date(n,f,k));return E}),o=n=>n?n.getFullYear()===_.getFullYear()&&n.getMonth()===_.getMonth()&&n.getDate()===_.getDate():!1,$=n=>{if(!n)return!1;const f=e(n);return i.getEventByDate(f).length>0},A=()=>{const n=new Date(c.value);n.setMonth(n.getMonth()-1),c.value=n},z=()=>{const n=new Date(c.value);n.setMonth(n.getMonth()+1),c.value=n},P=n=>{d("select-date",n)};return(n,f)=>(a(),r("div",Z,[u.value?(a(),r("div",ee,f[0]||(f[0]=[s("span",{class:"loading-text"},"Loading...",-1)]))):(a(),r("div",te,[s("div",se,[s("button",{onClick:A},"‚Äπ"),s("h2",null,v(g.value)+" Âπ¥ "+v(S.value+1)+" Êúà",1),s("button",{onClick:z},"‚Ä∫")]),s("div",ne,[(a(),r(b,null,Y(C,m=>s("div",{class:"day-name",key:m},v(m),1)),64)),(a(!0),r(b,null,Y(t.value,(m,T)=>(a(),r("div",{class:O(["day-cell",{today:o(m)}]),key:T,onClick:E=>m&&P(m)},[m?(a(),r("div",oe,[s("div",null,v(m.getDate()),1),$(m)?(a(),r("div",re,"‚òëÔ∏è")):p("",!0)])):(a(),r("div",le,"¬†"))],10,ae))),128))])]))]))}}),ie=B(ce,[["__scopeId","data-v-f795518a"]]),ue={class:"schedule-container"},de={class:"schedule-header"},_e={key:0,class:"actions"},ve={class:"schedule-content"},he={key:0,class:"loading"},me={key:1,class:"no-events"},pe={key:2,class:"event-list"},ge={class:"event-main"},fe={class:"event-time"},ye={class:"event-title"},ke={class:"event-extra"},we={key:0,class:"event-place"},De={key:1,class:"event-student"},Se={key:2,class:"event-type"},$e={key:0,class:"event-description"},be={key:1,class:"event-actions"},Ce=["onClick"],Ee=F({__name:"DailySchedule",props:{date:{}},setup(h){const l=h,i=j(),u=W(),d=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`,_=I(()=>i.getEventByDate(d(l.date)).sort((e,t)=>new Date(e.datetime).getTime()-new Date(t.datetime).getTime())),c=e=>e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=async()=>{var o;const e={user_id:((o=u.user)==null?void 0:o.id)||null,student_name:u.getUserName,datetime:new Date(l.date).toISOString(),end_datetime:null,place:"Office",title:"Custom Event",event_type:"custom"},t=await i.createEvent(e);t.success||alert(`Êñ∞Â¢ûÂ§±ÊïóÔºö${t.message}ÔºàÊ≥®ÊÑèÔºöÁî®Êà∂ÂèØÊñ∞Â¢ûÔºâ`)},S=async e=>{const t=await i.deleteEvent(e);t.success||alert(`Âà™Èô§Â§±ÊïóÔºö${t.message}ÔºàÊ≥®ÊÑèÔºöÂè™ÊúâË∂ÖÁ¥öÁî®Êà∂ÂèØÂà™Èô§Ôºâ`)},C=async()=>{const e=await i.importWorkhours();alert(e.success?e.message:`ÂåØÂÖ•Â§±ÊïóÔºö${e.message}ÔºàÊ≥®ÊÑèÔºöÂè™ÊúâË∂ÖÁ¥öÁî®Êà∂ÂèØËß∏ÁôºÔºâ`)};return(e,t)=>(a(),r("div",ue,[s("div",de,[s("h2",null,v(d(e.date))+" Ë°åÁ®ã",1),x(u).isAuthenticated?(a(),r("div",_e,[s("button",{class:"btn btn-primary",onClick:g},"Ôºã Êñ∞Â¢û"),x(u).isSuperuser?(a(),r("button",{key:0,class:"btn btn-secondary",onClick:C},"‚á™ ÂåØÂÖ•Â∑•ÊôÇ")):p("",!0)])):p("",!0),s("button",{class:"close-button",onClick:t[0]||(t[0]=o=>e.$emit("close"))},"‚úï")]),s("div",ve,[x(i).loading?(a(),r("div",he,"ËºâÂÖ•‰∏≠...")):_.value.length===0?(a(),r("div",me,"Ë©≤Êó•ÁÑ°Ë°åÁ®ã")):(a(),r("ul",pe,[(a(!0),r(b,null,Y(_.value,(o,$)=>(a(),r("li",{key:$,class:"event-item"},[s("div",ge,[s("span",fe,[D(v(c(o.datetime))+" ",1),o.end_datetime?(a(),r(b,{key:0},[D(" - "+v(c(o.end_datetime)),1)],64)):p("",!0)]),s("span",ye,"üìò "+v(o.title),1)]),s("div",ke,[o.place?(a(),r("span",we,"üìç "+v(o.place),1)):p("",!0),o.student_name?(a(),r("span",De,"üë§ "+v(o.student_name),1)):p("",!0),o.event_type?(a(),r("span",Se,"#"+v(o.event_type),1)):p("",!0)]),o.description?(a(),r("p",$e,v(o.description),1)):p("",!0),x(u).isSuperuser?(a(),r("div",be,[s("button",{class:"btn btn-danger btn-sm",onClick:A=>S(o.id)},"Âà™Èô§",8,Ce)])):p("",!0)]))),128))]))])]))}}),Me=B(Ee,[["__scopeId","data-v-05569e47"]]),xe={class:"main-content schedule-section"},Ie=F({__name:"StudentArea",setup(h){const l=y(null),i=d=>{l.value&&l.value.getFullYear()===d.getFullYear()&&l.value.getMonth()===d.getMonth()&&l.value.getDate()===d.getDate()?l.value=null:l.value=d},u=()=>{l.value=null};return(d,_)=>(a(),r(b,null,[w(Q),s("section",xe,[_[0]||(_[0]=s("div",{id:"BannerWrapper"},[s("h1",{class:"title"},"È†êÁ¥ÑÊôÇÊÆµ")],-1)),w(ie,{onSelectDate:i}),l.value?(a(),H(Me,{key:0,date:l.value,onClose:u},null,8,["date"])):p("",!0)])],64))}}),Te=B(Ie,[["__scopeId","data-v-e5d9453d"]]);export{Te as default};
