import{d as F,r as y,i as N,j as R,c as o,a,k as v,n as O,l as w,m as U,p as x,o as n,e as D,_ as B,f as V,q as I,t as h,F as C,s as Y,h as b,x as H}from"./index-B84UWxBe.js";import{u as W}from"./authStore-C5_qyCeR.js";const q={class:"navbar"},J=["aria-expanded"],G={key:0,class:"nav-links"},K=F({__name:"HamburgerButton",setup(m){const l=y(!1),u=y(window.innerWidth>=768),i=()=>{l.value=!l.value},d=()=>{u.value=window.innerWidth>=768};return N(()=>{d(),window.addEventListener("resize",d)}),R(()=>{window.removeEventListener("resize",d)}),(_,c)=>{const g=U("RouterLink");return n(),o("nav",q,[a("button",{class:O(["menu-icon",{active:l.value}]),onClick:i,"aria-label":"ÂàáÊèõÈÅ∏ÂñÆ","aria-expanded":l.value.toString()},c[0]||(c[0]=[a("span",{class:"bar top"},null,-1),a("span",{class:"bar middle"},null,-1),a("span",{class:"bar bottom"},null,-1)]),10,J),l.value||u.value?(n(),o("ul",G,[a("li",null,[w(g,{to:"/"},{default:x(()=>c[1]||(c[1]=[D("È¶ñÈ†Å",-1)])),_:1,__:[1]})]),a("li",null,[w(g,{to:"/login"},{default:x(()=>c[2]||(c[2]=[D("Â∏≥ËôüÁôªÂÖ•",-1)])),_:1,__:[2]})]),a("li",null,[w(g,{to:{name:"StudentProgress"}},{default:x(()=>c[3]||(c[3]=[D("Â≠∏ÁøíÁãÄÊ≥Å",-1)])),_:1,__:[3]})]),a("li",null,[w(g,{to:{name:"CourseIntro"}},{default:x(()=>c[4]||(c[4]=[D("Ë™≤Á®ã‰ªãÁ¥π",-1)])),_:1,__:[4]})])])):v("",!0)])}}}),Q=B(K,[["__scopeId","data-v-33f0fc4d"]]),L="https://home.sunnytseng.com/api/tutor/calendar/",X="https://home.sunnytseng.com/api/tutor/import-workhours/",j=V("calendar",()=>{const m=y([]),l=y(!1),u=W(),i=(e={})=>{const t={...e};return u.token&&(t.Authorization=`Bearer ${u.token}`),t},d=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`,_=e=>m.value.filter(t=>d(new Date(t.datetime))===e),c=async()=>{l.value=!0;try{const e=await fetch(L);if(!e.ok)throw new Error("Failed to load event data");const t=await e.json();m.value=t}catch(e){console.error("An error occurred while loading calendar events:",e)}finally{l.value=!1}};return{events:m,loading:l,getEventByDate:_,loadEvents:c,createEvent:async e=>{try{const t=await fetch(L,{method:"POST",headers:i({"Content-Type":"application/json"}),body:JSON.stringify(e)});if(!t.ok){const $=await t.text();throw new Error($||"Create failed")}const r=await t.json();return m.value.unshift(r),{success:!0,data:r}}catch(t){return{success:!1,message:(t==null?void 0:t.message)||"Create failed"}}},deleteEvent:async e=>{try{const t=await fetch(`${L}${e}/`,{method:"DELETE",headers:i()});if(!t.ok&&t.status!==204){const r=await t.text();throw new Error(r||"Delete failed")}return m.value=m.value.filter(r=>r.id!==e),{success:!0}}catch(t){return{success:!1,message:(t==null?void 0:t.message)||"Delete failed"}}},importWorkhours:async()=>{try{const e=await fetch(X,{method:"POST",headers:i()}),t=await e.json().catch(()=>({}));if(!e.ok)throw new Error((t==null?void 0:t.error)||(t==null?void 0:t.message)||"Import failed");return await c(),{success:!0,message:(t==null?void 0:t.message)||"Imported"}}catch(e){return{success:!1,message:(e==null?void 0:e.message)||"Import failed"}}}}}),Z={class:"calendar-container"},ee={key:0,class:"loading-overlay"},te={key:1},se={class:"calendar-header"},ne={class:"calendar-grid"},ae=["onClick"],oe={key:0},re={key:0},le={key:1},ce=F({__name:"ScheduleCalendar",emits:["select-date"],setup(m,{emit:l}){const u=j(),i=y(!0),d=l;N(async()=>{try{await u.loadEvents()}catch(s){console.error("Failed to load events:",s),alert("Unable to load events, please try again later!")}finally{i.value=!1}});const _=new Date,c=y(new Date),g=I(()=>c.value.getFullYear()),S=I(()=>c.value.getMonth()),E=["Êó•","‰∏Ä","‰∫å","‰∏â","Âõõ","‰∫î","ÂÖ≠"],e=s=>`${s.getFullYear()}-${(s.getMonth()+1).toString().padStart(2,"0")}-${s.getDate().toString().padStart(2,"0")}`,t=I(()=>{const s=g.value,f=S.value,p=new Date(s,f,1),T=new Date(s,f+1,0),M=[];for(let k=0;k<p.getDay();k++)M.push(null);for(let k=1;k<=T.getDate();k++)M.push(new Date(s,f,k));return M}),r=s=>s?s.getFullYear()===_.getFullYear()&&s.getMonth()===_.getMonth()&&s.getDate()===_.getDate():!1,$=s=>{if(!s)return!1;const f=e(s);return u.getEventByDate(f).length>0},A=()=>{const s=new Date(c.value);s.setMonth(s.getMonth()-1),c.value=s},z=()=>{const s=new Date(c.value);s.setMonth(s.getMonth()+1),c.value=s},P=s=>{d("select-date",s)};return(s,f)=>(n(),o("div",Z,[i.value?(n(),o("div",ee,f[0]||(f[0]=[a("span",{class:"loading-text"},"Loading...",-1)]))):(n(),o("div",te,[a("div",se,[a("button",{onClick:A},"‚Äπ"),a("h2",null,h(g.value)+" Âπ¥ "+h(S.value+1)+" Êúà",1),a("button",{onClick:z},"‚Ä∫")]),a("div",ne,[(n(),o(C,null,Y(E,p=>a("div",{class:"day-name",key:p},h(p),1)),64)),(n(!0),o(C,null,Y(t.value,(p,T)=>(n(),o("div",{class:O(["day-cell",{today:r(p)}]),key:T,onClick:M=>p&&P(p)},[p?(n(),o("div",oe,[a("div",null,h(p.getDate()),1),$(p)?(n(),o("div",re,"‚òëÔ∏è")):v("",!0)])):(n(),o("div",le,"¬†"))],10,ae))),128))])]))]))}}),ie=B(ce,[["__scopeId","data-v-f795518a"]]),ue={class:"schedule-container"},de={class:"schedule-header"},_e={key:0,class:"actions"},ve={class:"schedule-content"},he={key:0,class:"loading"},me={key:1,class:"no-events"},pe={key:2,class:"event-list"},ge={class:"event-main"},fe={class:"event-time"},ye={class:"event-title"},ke={class:"event-extra"},we={key:0,class:"event-place"},De={key:1,class:"event-student"},Se={key:2,class:"event-type"},$e={key:0,class:"event-description"},be={key:1,class:"event-actions"},Ce=["onClick"],Ee=F({__name:"DailySchedule",props:{date:{}},setup(m){const l=m,u=j(),i=W(),d=e=>`${e.getFullYear()}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getDate().toString().padStart(2,"0")}`,_=I(()=>u.getEventByDate(d(l.date)).sort((e,t)=>new Date(e.datetime).getTime()-new Date(t.datetime).getTime())),c=e=>e?new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",g=async()=>{var r;const e={user_id:((r=i.user)==null?void 0:r.id)||null,student_name:i.getUserName,datetime:new Date(l.date).toISOString(),end_datetime:null,place:"Office",title:"Custom Event",event_type:"custom"},t=await u.createEvent(e);t.success||alert(`Êñ∞Â¢ûÂ§±ÊïóÔºö${t.message}ÔºàÊ≥®ÊÑèÔºöÂè™ÊúâË∂ÖÁ¥öÁî®Êà∂ÂèØÊñ∞Â¢ûÔºâ`)},S=async e=>{const t=await u.deleteEvent(e);t.success||alert(`Âà™Èô§Â§±ÊïóÔºö${t.message}ÔºàÊ≥®ÊÑèÔºöÂè™ÊúâË∂ÖÁ¥öÁî®Êà∂ÂèØÂà™Èô§Ôºâ`)},E=async()=>{const e=await u.importWorkhours();alert(e.success?e.message:`ÂåØÂÖ•Â§±ÊïóÔºö${e.message}ÔºàÊ≥®ÊÑèÔºöÂè™ÊúâË∂ÖÁ¥öÁî®Êà∂ÂèØËß∏ÁôºÔºâ`)};return(e,t)=>(n(),o("div",ue,[a("div",de,[a("h2",null,h(d(e.date))+" Ë°åÁ®ã",1),b(i).isAuthenticated?(n(),o("div",_e,[b(i).isSuperuser?(n(),o("button",{key:0,class:"btn btn-primary",onClick:g},"Ôºã Êñ∞Â¢û")):v("",!0),b(i).isSuperuser?(n(),o("button",{key:1,class:"btn btn-secondary",onClick:E},"‚á™ ÂåØÂÖ•Â∑•ÊôÇ")):v("",!0)])):v("",!0),a("button",{class:"close-button",onClick:t[0]||(t[0]=r=>e.$emit("close"))},"‚úï")]),a("div",ve,[b(u).loading?(n(),o("div",he,"ËºâÂÖ•‰∏≠...")):_.value.length===0?(n(),o("div",me,"Ë©≤Êó•ÁÑ°Ë°åÁ®ã")):(n(),o("ul",pe,[(n(!0),o(C,null,Y(_.value,(r,$)=>(n(),o("li",{key:$,class:"event-item"},[a("div",ge,[a("span",fe,[D(h(c(r.datetime))+" ",1),r.end_datetime?(n(),o(C,{key:0},[D(" - "+h(c(r.end_datetime)),1)],64)):v("",!0)]),a("span",ye,"üìò "+h(r.title),1)]),a("div",ke,[r.place?(n(),o("span",we,"üìç "+h(r.place),1)):v("",!0),r.student_name?(n(),o("span",De,"üë§ "+h(r.student_name),1)):v("",!0),r.event_type?(n(),o("span",Se,"#"+h(r.event_type),1)):v("",!0)]),r.description?(n(),o("p",$e,h(r.description),1)):v("",!0),b(i).isSuperuser?(n(),o("div",be,[a("button",{class:"btn btn-danger btn-sm",onClick:A=>S(r.id)},"Âà™Èô§",8,Ce)])):v("",!0)]))),128))]))])]))}}),Me=B(Ee,[["__scopeId","data-v-d1af3eb5"]]),xe={class:"main-content schedule-section"},Ie=F({__name:"StudentArea",setup(m){const l=y(null),u=d=>{l.value&&l.value.getFullYear()===d.getFullYear()&&l.value.getMonth()===d.getMonth()&&l.value.getDate()===d.getDate()?l.value=null:l.value=d},i=()=>{l.value=null};return(d,_)=>(n(),o(C,null,[w(Q),a("section",xe,[_[0]||(_[0]=a("div",{id:"BannerWrapper"},[a("h1",{class:"title"},"È†êÁ¥ÑÊôÇÊÆµ")],-1)),w(ie,{onSelectDate:u}),l.value?(n(),H(Me,{key:0,date:l.value,onClose:i},null,8,["date"])):v("",!0)])],64))}}),Te=B(Ie,[["__scopeId","data-v-e5d9453d"]]);export{Te as default};
